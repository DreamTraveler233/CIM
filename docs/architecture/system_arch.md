# Sylar框架系统架构

## 1. 概述

Sylar是一个基于C++11的高性能服务框架，专注于提供日志、配置管理、协程调度、线程同步、定时器等基础组件，适用于高并发网络服务开发。

## 2. 核心模块

框架包含六大核心模块：

1. **日志系统** - 支持多级日志、格式化输出、多种Appender（如文件、控制台）、线程安全写入
2. **配置管理** - 基于YAML的配置解析，支持类型安全的变量注册与回调通知
3. **协程调度** - 提供Coroutine协程封装，支持Scheduler多线程调度和IOManager异步I/O事件驱动
4. **线程与同步** - 提供Thread、Semaphore、Lock等线程控制与同步机制
5. **定时器** - 实现高精度定时任务管理
6. **工具库** - 包含字符串转换（lexical_cast）、单例模式、不可拷贝基类等通用工具

## 3. 模块依赖关系

```
+-----------------+
|      LOG        |
+-----------------+
         ^
         |
+-----------------+     +-----------------+
|    CONFIG       |---->|      YAML       |
+-----------------+     +-----------------+
         ^
         |
+-----------------+
|     CORE        |
| (macro, util,   |
|  thread, etc.)  |
+-----------------+
         ^
         |
+-----------------+
|    RUNTIME      |
| (coroutine,     |
|  scheduler,     |
|  iomanager)     |
+-----------------+
         ^
         |
+-----------------+
|    SYSTEM       |
| (hook,          |
|  fd_manager)    |
+-----------------+
         ^
         |
+-----------------+
|      NET        |
| (address,       |
|  socket,        |
|  endian)        |
+-----------------+
```

## 4. 设计模式

1. **单例模式** - 通过 `singleton.hpp` 实现全局唯一实例（如 LoggerManager、Config）
2. **观察者模式** - Config 变量支持变更回调
3. **RAII 模式** - 在 `lock.hpp` 中使用 RAII 管理锁资源
4. **工厂模式** - LogAppender 和 Formatter 的注册与创建
5. **反应器模式** - IOManager 基于 epoll/kqueue 实现事件循环

## 5. 技术选型

- C++ 标准: C++11
- 构建系统: CMake 3.10+
- 日志配置: YAML（依赖 yaml-cpp 库）
- 编译器标志: `-O3 -g -Wall -Werror -rdynamic -std=c++11`